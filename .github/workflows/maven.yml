name: Github CI

on: [push, pull_request]

jobs:
  build:

    runs-on: ubuntu-latest
    strategy:
      matrix:
        java: [ '1.8', '11.0.4' ]

    steps:
    - name: Clone
      uses: actions/checkout@v1
    - name: Set up JDK ${{ matrix.java }}
      uses: actions/setup-java@v1
      with:
        java-version: ${{ matrix.java }}
    - name: Build
      run: mvn clean install -Pintegration-tests
    - name: Publish website
      env:
        WEBSITE_PUBLISH_USERNAME: ${{ secrets.WEBSITE_PUBLISH_USERNAME }}
        WEBSITE_PUBLISH_PASSWORD: ${{ secrets.WEBSITE_PUBLISH_PASSWORD }}
      run: |
        # todo: setup credentials
        echo cd documentation && mvn clean prepare-package scm-publish:publish-scm -DskipTests && cd -
      if: github.ref == 'refs/heads/master' && github.event_name == 'push' && matrix.java == '1.8'
